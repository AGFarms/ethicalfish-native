{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":93,"column":37,"index":3761}}],"key":"8I802z/QkQYw0PV6ZCqhBNDwn0Q="}},{"name":"../../errors/request.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":4,"column":21,"index":129},"end":{"line":4,"column":55,"index":163}}],"key":"De7+e6OpHDMvLcTikHUrC1TDF9U="}},{"name":"../../errors/transport.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":5,"column":23,"index":188},"end":{"line":5,"column":59,"index":224}}],"key":"3O9RZZ5aqMR7xl7gZdyFzSij2Lo="}},{"name":"../../utils/rpc/compat.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":6,"column":20,"index":246},"end":{"line":6,"column":56,"index":282}}],"key":"lvQCIgQVnsBVhCwuYuPICpFHGR0="}},{"name":"../../utils/rpc/webSocket.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":7,"column":23,"index":307},"end":{"line":7,"column":62,"index":346}}],"key":"flKd2ZWa2O8HjSYv1RjmIE8H3/s="}},{"name":"./createTransport.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":8,"column":29,"index":377},"end":{"line":8,"column":60,"index":408}}],"key":"zr7a0xQkLAysUze0H3cD5eiTvKk="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _asyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.webSocket = webSocket;\n  var request_js_1 = require(_dependencyMap[1], \"../../errors/request.js\");\n  var transport_js_1 = require(_dependencyMap[2], \"../../errors/transport.js\");\n  var compat_js_1 = require(_dependencyMap[3], \"../../utils/rpc/compat.js\");\n  var webSocket_js_1 = require(_dependencyMap[4], \"../../utils/rpc/webSocket.js\");\n  var createTransport_js_1 = require(_dependencyMap[5], \"./createTransport.js\");\n  function webSocket(url) {\n    var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var keepAlive = config.keepAlive,\n      _config$key = config.key,\n      key = _config$key === void 0 ? 'webSocket' : _config$key,\n      methods = config.methods,\n      _config$name = config.name,\n      name = _config$name === void 0 ? 'WebSocket JSON-RPC' : _config$name,\n      reconnect = config.reconnect,\n      retryDelay = config.retryDelay;\n    return _ref => {\n      var chain = _ref.chain,\n        retryCount_ = _ref.retryCount,\n        timeout_ = _ref.timeout;\n      var retryCount = config.retryCount ?? retryCount_;\n      var timeout = timeout_ ?? config.timeout ?? 10_000;\n      var url_ = url || chain?.rpcUrls.default.webSocket?.[0];\n      if (!url_) throw new transport_js_1.UrlRequiredError();\n      return (0, createTransport_js_1.createTransport)({\n        key,\n        methods,\n        name,\n        request(_ref2) {\n          return _asyncToGenerator(function* () {\n            var method = _ref2.method,\n              params = _ref2.params;\n            var body = {\n              method,\n              params\n            };\n            var rpcClient = yield (0, webSocket_js_1.getWebSocketRpcClient)(url_, {\n              keepAlive,\n              reconnect\n            });\n            var _yield$rpcClient$requ = yield rpcClient.requestAsync({\n                body,\n                timeout\n              }),\n              error = _yield$rpcClient$requ.error,\n              result = _yield$rpcClient$requ.result;\n            if (error) throw new request_js_1.RpcRequestError({\n              body,\n              error,\n              url: url_\n            });\n            return result;\n          })();\n        },\n        retryCount,\n        retryDelay,\n        timeout,\n        type: 'webSocket'\n      }, {\n        getSocket() {\n          return (0, compat_js_1.getSocket)(url_);\n        },\n        getRpcClient() {\n          return (0, webSocket_js_1.getWebSocketRpcClient)(url_);\n        },\n        subscribe(_ref3) {\n          return _asyncToGenerator(function* () {\n            var params = _ref3.params,\n              onData = _ref3.onData,\n              onError = _ref3.onError;\n            var rpcClient = yield (0, webSocket_js_1.getWebSocketRpcClient)(url_);\n            var _yield$Promise = yield new Promise((resolve, reject) => rpcClient.request({\n                body: {\n                  method: 'eth_subscribe',\n                  params\n                },\n                onError(error) {\n                  reject(error);\n                  onError?.(error);\n                  return;\n                },\n                onResponse(response) {\n                  if (response.error) {\n                    reject(response.error);\n                    onError?.(response.error);\n                    return;\n                  }\n                  if (typeof response.id === 'number') {\n                    resolve(response);\n                    return;\n                  }\n                  if (response.method !== 'eth_subscription') return;\n                  onData(response.params);\n                }\n              })),\n              subscriptionId = _yield$Promise.result;\n            return {\n              subscriptionId,\n              unsubscribe() {\n                return _asyncToGenerator(function* () {\n                  return new Promise(resolve => rpcClient.request({\n                    body: {\n                      method: 'eth_unsubscribe',\n                      params: [subscriptionId]\n                    },\n                    onResponse: resolve\n                  }));\n                })();\n              }\n            };\n          })();\n        }\n      });\n    };\n  }\n});","lineCount":123,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_asyncToGenerator"],[4,23,1,13],[4,26,1,13,"require"],[4,33,1,13],[4,34,1,13,"_dependencyMap"],[4,48,1,13],[5,2,2,0,"Object"],[5,8,2,6],[5,9,2,7,"defineProperty"],[5,23,2,21],[5,24,2,22,"exports"],[5,31,2,29],[5,33,2,31],[5,45,2,43],[5,47,2,45],[6,4,2,47,"value"],[6,9,2,52],[6,11,2,54],[7,2,2,59],[7,3,2,60],[7,4,2,61],[8,2,3,0,"exports"],[8,9,3,7],[8,10,3,8,"webSocket"],[8,19,3,17],[8,22,3,20,"webSocket"],[8,31,3,29],[9,2,4,0],[9,6,4,6,"request_js_1"],[9,18,4,18],[9,21,4,21,"require"],[9,28,4,28],[9,29,4,28,"_dependencyMap"],[9,43,4,28],[9,73,4,54],[9,74,4,55],[10,2,5,0],[10,6,5,6,"transport_js_1"],[10,20,5,20],[10,23,5,23,"require"],[10,30,5,30],[10,31,5,30,"_dependencyMap"],[10,45,5,30],[10,77,5,58],[10,78,5,59],[11,2,6,0],[11,6,6,6,"compat_js_1"],[11,17,6,17],[11,20,6,20,"require"],[11,27,6,27],[11,28,6,27,"_dependencyMap"],[11,42,6,27],[11,74,6,55],[11,75,6,56],[12,2,7,0],[12,6,7,6,"webSocket_js_1"],[12,20,7,20],[12,23,7,23,"require"],[12,30,7,30],[12,31,7,30,"_dependencyMap"],[12,45,7,30],[12,80,7,61],[12,81,7,62],[13,2,8,0],[13,6,8,6,"createTransport_js_1"],[13,26,8,26],[13,29,8,29,"require"],[13,36,8,36],[13,37,8,36,"_dependencyMap"],[13,51,8,36],[13,78,8,59],[13,79,8,60],[14,2,9,0],[14,11,9,9,"webSocket"],[14,20,9,18,"webSocket"],[14,21,9,19,"url"],[14,24,9,22],[14,26,9,37],[15,4,9,37],[15,8,9,24,"config"],[15,14,9,30],[15,17,9,30,"arguments"],[15,26,9,30],[15,27,9,30,"length"],[15,33,9,30],[15,41,9,30,"arguments"],[15,50,9,30],[15,58,9,30,"undefined"],[15,67,9,30],[15,70,9,30,"arguments"],[15,79,9,30],[15,85,9,33],[15,86,9,34],[15,87,9,35],[16,4,10,4],[16,8,10,12,"keepAlive"],[16,17,10,21],[16,20,10,107,"config"],[16,26,10,113],[16,27,10,12,"keepAlive"],[16,36,10,21],[17,6,10,21,"_config$key"],[17,17,10,21],[17,20,10,107,"config"],[17,26,10,113],[17,27,10,23,"key"],[17,30,10,26],[18,6,10,23,"key"],[18,9,10,26],[18,12,10,26,"_config$key"],[18,23,10,26],[18,37,10,29],[18,48,10,40],[18,51,10,40,"_config$key"],[18,62,10,40],[19,6,10,42,"methods"],[19,13,10,49],[19,16,10,107,"config"],[19,22,10,113],[19,23,10,42,"methods"],[19,30,10,49],[20,6,10,49,"_config$name"],[20,18,10,49],[20,21,10,107,"config"],[20,27,10,113],[20,28,10,51,"name"],[20,32,10,55],[21,6,10,51,"name"],[21,10,10,55],[21,13,10,55,"_config$name"],[21,25,10,55],[21,39,10,58],[21,59,10,78],[21,62,10,78,"_config$name"],[21,74,10,78],[22,6,10,80,"reconnect"],[22,15,10,89],[22,18,10,107,"config"],[22,24,10,113],[22,25,10,80,"reconnect"],[22,34,10,89],[23,6,10,91,"retryDelay"],[23,16,10,101],[23,19,10,107,"config"],[23,25,10,113],[23,26,10,91,"retryDelay"],[23,36,10,101],[24,4,11,4],[24,11,11,11,"_ref"],[24,15,11,11],[24,19,11,70],[25,6,11,70],[25,10,11,14,"chain"],[25,15,11,19],[25,18,11,19,"_ref"],[25,22,11,19],[25,23,11,14,"chain"],[25,28,11,19],[26,8,11,33,"retryCount_"],[26,19,11,44],[26,22,11,44,"_ref"],[26,26,11,44],[26,27,11,21,"retryCount"],[26,37,11,31],[27,8,11,55,"timeout_"],[27,16,11,63],[27,19,11,63,"_ref"],[27,23,11,63],[27,24,11,46,"timeout"],[27,31,11,53],[28,6,12,8],[28,10,12,14,"retryCount"],[28,20,12,24],[28,23,12,27,"config"],[28,29,12,33],[28,30,12,34,"retryCount"],[28,40,12,44],[28,44,12,48,"retryCount_"],[28,55,12,59],[29,6,13,8],[29,10,13,14,"timeout"],[29,17,13,21],[29,20,13,24,"timeout_"],[29,28,13,32],[29,32,13,36,"config"],[29,38,13,42],[29,39,13,43,"timeout"],[29,46,13,50],[29,50,13,54],[29,56,13,60],[30,6,14,8],[30,10,14,14,"url_"],[30,14,14,18],[30,17,14,21,"url"],[30,20,14,24],[30,24,14,28,"chain"],[30,29,14,33],[30,31,14,35,"rpcUrls"],[30,38,14,42],[30,39,14,43,"default"],[30,46,14,50],[30,47,14,51,"webSocket"],[30,56,14,60],[30,59,14,63],[30,60,14,64],[30,61,14,65],[31,6,15,8],[31,10,15,12],[31,11,15,13,"url_"],[31,15,15,17],[31,17,16,12],[31,23,16,18],[31,27,16,22,"transport_js_1"],[31,41,16,36],[31,42,16,37,"UrlRequiredError"],[31,58,16,53],[31,59,16,54],[31,60,16,55],[32,6,17,8],[32,13,17,15],[32,14,17,16],[32,15,17,17],[32,17,17,19,"createTransport_js_1"],[32,37,17,39],[32,38,17,40,"createTransport"],[32,53,17,55],[32,55,17,57],[33,8,18,12,"key"],[33,11,18,15],[34,8,19,12,"methods"],[34,15,19,19],[35,8,20,12,"name"],[35,12,20,16],[36,8,21,18,"request"],[36,15,21,25,"request"],[36,16,21,25,"_ref2"],[36,21,21,25],[36,23,21,46],[37,10,21,46],[37,17,21,46,"_asyncToGenerator"],[37,34,21,46],[38,12,21,46],[38,16,21,28,"method"],[38,22,21,34],[38,25,21,34,"_ref2"],[38,30,21,34],[38,31,21,28,"method"],[38,37,21,34],[39,14,21,36,"params"],[39,20,21,42],[39,23,21,42,"_ref2"],[39,28,21,42],[39,29,21,36,"params"],[39,35,21,42],[40,12,22,16],[40,16,22,22,"body"],[40,20,22,26],[40,23,22,29],[41,14,22,31,"method"],[41,20,22,37],[42,14,22,39,"params"],[43,12,22,46],[43,13,22,47],[44,12,23,16],[44,16,23,22,"rpcClient"],[44,25,23,31],[44,34,23,40],[44,35,23,41],[44,36,23,42],[44,38,23,44,"webSocket_js_1"],[44,52,23,58],[44,53,23,59,"getWebSocketRpcClient"],[44,74,23,80],[44,76,23,82,"url_"],[44,80,23,86],[44,82,23,88],[45,14,24,20,"keepAlive"],[45,23,24,29],[46,14,25,20,"reconnect"],[47,12,26,16],[47,13,26,17],[47,14,26,18],[48,12,27,16],[48,16,27,16,"_yield$rpcClient$requ"],[48,37,27,16],[48,46,27,48,"rpcClient"],[48,55,27,57],[48,56,27,58,"requestAsync"],[48,68,27,70],[48,69,27,71],[49,16,28,20,"body"],[49,20,28,24],[50,16,29,20,"timeout"],[51,14,30,16],[51,15,30,17],[51,16,30,18],[52,14,27,24,"error"],[52,19,27,29],[52,22,27,29,"_yield$rpcClient$requ"],[52,43,27,29],[52,44,27,24,"error"],[52,49,27,29],[53,14,27,31,"result"],[53,20,27,37],[53,23,27,37,"_yield$rpcClient$requ"],[53,44,27,37],[53,45,27,31,"result"],[53,51,27,37],[54,12,31,16],[54,16,31,20,"error"],[54,21,31,25],[54,23,32,20],[54,29,32,26],[54,33,32,30,"request_js_1"],[54,45,32,42],[54,46,32,43,"RpcRequestError"],[54,61,32,58],[54,62,32,59],[55,14,33,24,"body"],[55,18,33,28],[56,14,34,24,"error"],[56,19,34,29],[57,14,35,24,"url"],[57,17,35,27],[57,19,35,29,"url_"],[58,12,36,20],[58,13,36,21],[58,14,36,22],[59,12,37,16],[59,19,37,23,"result"],[59,25,37,29],[60,10,37,30],[61,8,38,12],[61,9,38,13],[62,8,39,12,"retryCount"],[62,18,39,22],[63,8,40,12,"retryDelay"],[63,18,40,22],[64,8,41,12,"timeout"],[64,15,41,19],[65,8,42,12,"type"],[65,12,42,16],[65,14,42,18],[66,6,43,8],[66,7,43,9],[66,9,43,11],[67,8,44,12,"getSocket"],[67,17,44,21,"getSocket"],[67,18,44,21],[67,20,44,24],[68,10,45,16],[68,17,45,23],[68,18,45,24],[68,19,45,25],[68,21,45,27,"compat_js_1"],[68,32,45,38],[68,33,45,39,"getSocket"],[68,42,45,48],[68,44,45,50,"url_"],[68,48,45,54],[68,49,45,55],[69,8,46,12],[69,9,46,13],[70,8,47,12,"getRpcClient"],[70,20,47,24,"getRpcClient"],[70,21,47,24],[70,23,47,27],[71,10,48,16],[71,17,48,23],[71,18,48,24],[71,19,48,25],[71,21,48,27,"webSocket_js_1"],[71,35,48,41],[71,36,48,42,"getWebSocketRpcClient"],[71,57,48,63],[71,59,48,65,"url_"],[71,63,48,69],[71,64,48,70],[72,8,49,12],[72,9,49,13],[73,8,50,18,"subscribe"],[73,17,50,27,"subscribe"],[73,18,50,27,"_ref3"],[73,23,50,27],[73,25,50,57],[74,10,50,57],[74,17,50,57,"_asyncToGenerator"],[74,34,50,57],[75,12,50,57],[75,16,50,30,"params"],[75,22,50,36],[75,25,50,36,"_ref3"],[75,30,50,36],[75,31,50,30,"params"],[75,37,50,36],[76,14,50,38,"onData"],[76,20,50,44],[76,23,50,44,"_ref3"],[76,28,50,44],[76,29,50,38,"onData"],[76,35,50,44],[77,14,50,46,"onError"],[77,21,50,53],[77,24,50,53,"_ref3"],[77,29,50,53],[77,30,50,46,"onError"],[77,37,50,53],[78,12,51,16],[78,16,51,22,"rpcClient"],[78,25,51,31],[78,34,51,40],[78,35,51,41],[78,36,51,42],[78,38,51,44,"webSocket_js_1"],[78,52,51,58],[78,53,51,59,"getWebSocketRpcClient"],[78,74,51,80],[78,76,51,82,"url_"],[78,80,51,86],[78,81,51,87],[79,12,52,16],[79,16,52,16,"_yield$Promise"],[79,30,52,16],[79,39,52,57],[79,43,52,61,"Promise"],[79,50,52,68],[79,51,52,69],[79,52,52,70,"resolve"],[79,59,52,77],[79,61,52,79,"reject"],[79,67,52,85],[79,72,52,90,"rpcClient"],[79,81,52,99],[79,82,52,100,"request"],[79,89,52,107],[79,90,52,108],[80,16,53,20,"body"],[80,20,53,24],[80,22,53,26],[81,18,54,24,"method"],[81,24,54,30],[81,26,54,32],[81,41,54,47],[82,18,55,24,"params"],[83,16,56,20],[83,17,56,21],[84,16,57,20,"onError"],[84,23,57,27,"onError"],[84,24,57,28,"error"],[84,29,57,33],[84,31,57,35],[85,18,58,24,"reject"],[85,24,58,30],[85,25,58,31,"error"],[85,30,58,36],[85,31,58,37],[86,18,59,24,"onError"],[86,25,59,31],[86,28,59,34,"error"],[86,33,59,39],[86,34,59,40],[87,18,60,24],[88,16,61,20],[88,17,61,21],[89,16,62,20,"onResponse"],[89,26,62,30,"onResponse"],[89,27,62,31,"response"],[89,35,62,39],[89,37,62,41],[90,18,63,24],[90,22,63,28,"response"],[90,30,63,36],[90,31,63,37,"error"],[90,36,63,42],[90,38,63,44],[91,20,64,28,"reject"],[91,26,64,34],[91,27,64,35,"response"],[91,35,64,43],[91,36,64,44,"error"],[91,41,64,49],[91,42,64,50],[92,20,65,28,"onError"],[92,27,65,35],[92,30,65,38,"response"],[92,38,65,46],[92,39,65,47,"error"],[92,44,65,52],[92,45,65,53],[93,20,66,28],[94,18,67,24],[95,18,68,24],[95,22,68,28],[95,29,68,35,"response"],[95,37,68,43],[95,38,68,44,"id"],[95,40,68,46],[95,45,68,51],[95,53,68,59],[95,55,68,61],[96,20,69,28,"resolve"],[96,27,69,35],[96,28,69,36,"response"],[96,36,69,44],[96,37,69,45],[97,20,70,28],[98,18,71,24],[99,18,72,24],[99,22,72,28,"response"],[99,30,72,36],[99,31,72,37,"method"],[99,37,72,43],[99,42,72,48],[99,60,72,66],[99,62,73,28],[100,18,74,24,"onData"],[100,24,74,30],[100,25,74,31,"response"],[100,33,74,39],[100,34,74,40,"params"],[100,40,74,46],[100,41,74,47],[101,16,75,20],[102,14,76,16],[102,15,76,17],[102,16,76,18],[102,17,76,19],[103,14,52,32,"subscriptionId"],[103,28,52,46],[103,31,52,46,"_yield$Promise"],[103,45,52,46],[103,46,52,24,"result"],[103,52,52,30],[104,12,77,16],[104,19,77,23],[105,14,78,20,"subscriptionId"],[105,28,78,34],[106,14,79,26,"unsubscribe"],[106,25,79,37,"unsubscribe"],[106,26,79,37],[106,28,79,40],[107,16,79,40],[107,23,79,40,"_asyncToGenerator"],[107,40,79,40],[108,18,80,24],[108,25,80,31],[108,29,80,35,"Promise"],[108,36,80,42],[108,37,80,44,"resolve"],[108,44,80,51],[108,48,80,56,"rpcClient"],[108,57,80,65],[108,58,80,66,"request"],[108,65,80,73],[108,66,80,74],[109,20,81,28,"body"],[109,24,81,32],[109,26,81,34],[110,22,82,32,"method"],[110,28,82,38],[110,30,82,40],[110,47,82,57],[111,22,83,32,"params"],[111,28,83,38],[111,30,83,40],[111,31,83,41,"subscriptionId"],[111,45,83,55],[112,20,84,28],[112,21,84,29],[113,20,85,28,"onResponse"],[113,30,85,38],[113,32,85,40,"resolve"],[114,18,86,24],[114,19,86,25],[114,20,86,26],[114,21,86,27],[115,16,86,28],[116,14,87,20],[117,12,88,16],[117,13,88,17],[118,10,88,18],[119,8,89,12],[120,6,90,8],[120,7,90,9],[120,8,90,10],[121,4,91,4],[121,5,91,5],[122,2,92,0],[123,0,92,1],[123,3]],"functionMap":{"names":["<global>","webSocket","<anonymous>","request","getSocket","getRpcClient","subscribe","Promise$argument_0","rpcClient.request$argument_0.onError","rpcClient.request$argument_0.onResponse","unsubscribe"],"mappings":"AAA;ACQ;WCE;YCU;aDiB;YEM;aFE;YGC;aHE;YIC;qECE;oBCK;qBDI;oBEC;qBFa;kBDC;oBIG;2CHC;0BGM;qBJC;aJE;KDE;CDC"}},"type":"js/module"}]}
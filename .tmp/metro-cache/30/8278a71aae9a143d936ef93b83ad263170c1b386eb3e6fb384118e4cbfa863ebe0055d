{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":76,"column":37,"index":3261}}],"key":"8I802z/QkQYw0PV6ZCqhBNDwn0Q="}},{"name":"../../errors/request.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":4,"column":21,"index":153},"end":{"line":4,"column":55,"index":187}}],"key":"De7+e6OpHDMvLcTikHUrC1TDF9U="}},{"name":"./socket.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":5,"column":20,"index":209},"end":{"line":5,"column":42,"index":231}}],"key":"pK9whj3rt40i40H1uEg0YptUIQI="}},{"name":"isows","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":10,"column":65,"index":519},"end":{"line":10,"column":81,"index":535}}],"key":"Pemt/DB4S1pe6+N2l40fiAzu1jM="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _asyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getWebSocketRpcClient = getWebSocketRpcClient;\n  var request_js_1 = require(_dependencyMap[1], \"../../errors/request.js\");\n  var socket_js_1 = require(_dependencyMap[2], \"./socket.js\");\n  function getWebSocketRpcClient(_x) {\n    return _getWebSocketRpcClient.apply(this, arguments);\n  }\n  function _getWebSocketRpcClient() {\n    _getWebSocketRpcClient = _asyncToGenerator(function* (url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var keepAlive = options.keepAlive,\n        reconnect = options.reconnect;\n      return (0, socket_js_1.getSocketRpcClient)({\n        getSocket(_ref) {\n          return _asyncToGenerator(function* () {\n            var onClose = _ref.onClose,\n              onError = _ref.onError,\n              onOpen = _ref.onOpen,\n              onResponse = _ref.onResponse;\n            var WebSocket = yield Promise.resolve().then(() => require(_dependencyMap[3], \"isows\")).then(module => module.WebSocket);\n            var socket = new WebSocket(url);\n            function onClose_() {\n              socket.removeEventListener('close', onClose_);\n              socket.removeEventListener('message', onMessage);\n              socket.removeEventListener('error', onError);\n              socket.removeEventListener('open', onOpen);\n              onClose();\n            }\n            function onMessage(_ref2) {\n              var data = _ref2.data;\n              onResponse(JSON.parse(data));\n            }\n            socket.addEventListener('close', onClose_);\n            socket.addEventListener('message', onMessage);\n            socket.addEventListener('error', onError);\n            socket.addEventListener('open', onOpen);\n            if (socket.readyState === WebSocket.CONNECTING) {\n              yield new Promise((resolve, reject) => {\n                if (!socket) return;\n                socket.onopen = resolve;\n                socket.onerror = reject;\n              });\n            }\n            var close_ = socket.close;\n            return Object.assign(socket, {\n              close() {\n                close_.bind(socket)();\n                onClose_();\n              },\n              ping() {\n                try {\n                  if (socket.readyState === socket.CLOSED || socket.readyState === socket.CLOSING) throw new request_js_1.WebSocketRequestError({\n                    url: socket.url,\n                    cause: new request_js_1.SocketClosedError({\n                      url: socket.url\n                    })\n                  });\n                  var body = {\n                    jsonrpc: '2.0',\n                    method: 'net_version',\n                    params: []\n                  };\n                  socket.send(JSON.stringify(body));\n                } catch (error) {\n                  onError(error);\n                }\n              },\n              request(_ref3) {\n                var body = _ref3.body;\n                if (socket.readyState === socket.CLOSED || socket.readyState === socket.CLOSING) throw new request_js_1.WebSocketRequestError({\n                  body,\n                  url: socket.url,\n                  cause: new request_js_1.SocketClosedError({\n                    url: socket.url\n                  })\n                });\n                return socket.send(JSON.stringify(body));\n              }\n            });\n          })();\n        },\n        keepAlive,\n        reconnect,\n        url\n      });\n    });\n    return _getWebSocketRpcClient.apply(this, arguments);\n  }\n});","lineCount":95,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_asyncToGenerator"],[4,23,1,13],[4,26,1,13,"require"],[4,33,1,13],[4,34,1,13,"_dependencyMap"],[4,48,1,13],[5,2,2,0,"Object"],[5,8,2,6],[5,9,2,7,"defineProperty"],[5,23,2,21],[5,24,2,22,"exports"],[5,31,2,29],[5,33,2,31],[5,45,2,43],[5,47,2,45],[6,4,2,47,"value"],[6,9,2,52],[6,11,2,54],[7,2,2,59],[7,3,2,60],[7,4,2,61],[8,2,3,0,"exports"],[8,9,3,7],[8,10,3,8,"getWebSocketRpcClient"],[8,31,3,29],[8,34,3,32,"getWebSocketRpcClient"],[8,55,3,53],[9,2,4,0],[9,6,4,6,"request_js_1"],[9,18,4,18],[9,21,4,21,"require"],[9,28,4,28],[9,29,4,28,"_dependencyMap"],[9,43,4,28],[9,73,4,54],[9,74,4,55],[10,2,5,0],[10,6,5,6,"socket_js_1"],[10,17,5,17],[10,20,5,20,"require"],[10,27,5,27],[10,28,5,27,"_dependencyMap"],[10,42,5,27],[10,60,5,41],[10,61,5,42],[11,2,5,43],[11,11,6,15,"getWebSocketRpcClient"],[11,32,6,36,"getWebSocketRpcClient"],[11,33,6,36,"_x"],[11,35,6,36],[12,4,6,36],[12,11,6,36,"_getWebSocketRpcClient"],[12,33,6,36],[12,34,6,36,"apply"],[12,39,6,36],[12,46,6,36,"arguments"],[12,55,6,36],[13,2,6,36],[14,2,6,36],[14,11,6,36,"_getWebSocketRpcClient"],[14,34,6,36],[15,4,6,36,"_getWebSocketRpcClient"],[15,26,6,36],[15,29,6,36,"_asyncToGenerator"],[15,46,6,36],[15,47,6,0],[15,58,6,37,"url"],[15,61,6,40],[15,63,6,56],[16,6,6,56],[16,10,6,42,"options"],[16,17,6,49],[16,20,6,49,"arguments"],[16,29,6,49],[16,30,6,49,"length"],[16,36,6,49],[16,44,6,49,"arguments"],[16,53,6,49],[16,61,6,49,"undefined"],[16,70,6,49],[16,73,6,49,"arguments"],[16,82,6,49],[16,88,6,52],[16,89,6,53],[16,90,6,54],[17,6,7,4],[17,10,7,12,"keepAlive"],[17,19,7,21],[17,22,7,37,"options"],[17,29,7,44],[17,30,7,12,"keepAlive"],[17,39,7,21],[18,8,7,23,"reconnect"],[18,17,7,32],[18,20,7,37,"options"],[18,27,7,44],[18,28,7,23,"reconnect"],[18,37,7,32],[19,6,8,4],[19,13,8,11],[19,14,8,12],[19,15,8,13],[19,17,8,15,"socket_js_1"],[19,28,8,26],[19,29,8,27,"getSocketRpcClient"],[19,47,8,45],[19,49,8,47],[20,8,9,14,"getSocket"],[20,17,9,23,"getSocket"],[20,18,9,23,"_ref"],[20,22,9,23],[20,24,9,66],[21,10,9,66],[21,17,9,66,"_asyncToGenerator"],[21,34,9,66],[22,12,9,66],[22,16,9,26,"onClose"],[22,23,9,33],[22,26,9,33,"_ref"],[22,30,9,33],[22,31,9,26,"onClose"],[22,38,9,33],[23,14,9,35,"onError"],[23,21,9,42],[23,24,9,42,"_ref"],[23,28,9,42],[23,29,9,35,"onError"],[23,36,9,42],[24,14,9,44,"onOpen"],[24,20,9,50],[24,23,9,50,"_ref"],[24,27,9,50],[24,28,9,44,"onOpen"],[24,34,9,50],[25,14,9,52,"onResponse"],[25,24,9,62],[25,27,9,62,"_ref"],[25,31,9,62],[25,32,9,52,"onResponse"],[25,42,9,62],[26,12,10,12],[26,16,10,18,"WebSocket"],[26,25,10,27],[26,34,10,36,"Promise"],[26,41,10,43],[26,42,10,44,"resolve"],[26,49,10,51],[26,50,10,52],[26,51,10,53],[26,52,10,54,"then"],[26,56,10,58],[26,57,10,59],[26,63,10,65,"require"],[26,70,10,72],[26,71,10,72,"_dependencyMap"],[26,85,10,72],[26,97,10,80],[26,98,10,81],[26,99,10,82],[26,100,10,83,"then"],[26,104,10,87],[26,105,10,89,"module"],[26,111,10,95],[26,115,10,100,"module"],[26,121,10,106],[26,122,10,107,"WebSocket"],[26,131,10,116],[26,132,10,117],[27,12,11,12],[27,16,11,18,"socket"],[27,22,11,24],[27,25,11,27],[27,29,11,31,"WebSocket"],[27,38,11,40],[27,39,11,41,"url"],[27,42,11,44],[27,43,11,45],[28,12,12,12],[28,21,12,21,"onClose_"],[28,29,12,29,"onClose_"],[28,30,12,29],[28,32,12,32],[29,14,13,16,"socket"],[29,20,13,22],[29,21,13,23,"removeEventListener"],[29,40,13,42],[29,41,13,43],[29,48,13,50],[29,50,13,52,"onClose_"],[29,58,13,60],[29,59,13,61],[30,14,14,16,"socket"],[30,20,14,22],[30,21,14,23,"removeEventListener"],[30,40,14,42],[30,41,14,43],[30,50,14,52],[30,52,14,54,"onMessage"],[30,61,14,63],[30,62,14,64],[31,14,15,16,"socket"],[31,20,15,22],[31,21,15,23,"removeEventListener"],[31,40,15,42],[31,41,15,43],[31,48,15,50],[31,50,15,52,"onError"],[31,57,15,59],[31,58,15,60],[32,14,16,16,"socket"],[32,20,16,22],[32,21,16,23,"removeEventListener"],[32,40,16,42],[32,41,16,43],[32,47,16,49],[32,49,16,51,"onOpen"],[32,55,16,57],[32,56,16,58],[33,14,17,16,"onClose"],[33,21,17,23],[33,22,17,24],[33,23,17,25],[34,12,18,12],[35,12,19,12],[35,21,19,21,"onMessage"],[35,30,19,30,"onMessage"],[35,31,19,30,"_ref2"],[35,36,19,30],[35,38,19,41],[36,14,19,41],[36,18,19,33,"data"],[36,22,19,37],[36,25,19,37,"_ref2"],[36,30,19,37],[36,31,19,33,"data"],[36,35,19,37],[37,14,20,16,"onResponse"],[37,24,20,26],[37,25,20,27,"JSON"],[37,29,20,31],[37,30,20,32,"parse"],[37,35,20,37],[37,36,20,38,"data"],[37,40,20,42],[37,41,20,43],[37,42,20,44],[38,12,21,12],[39,12,22,12,"socket"],[39,18,22,18],[39,19,22,19,"addEventListener"],[39,35,22,35],[39,36,22,36],[39,43,22,43],[39,45,22,45,"onClose_"],[39,53,22,53],[39,54,22,54],[40,12,23,12,"socket"],[40,18,23,18],[40,19,23,19,"addEventListener"],[40,35,23,35],[40,36,23,36],[40,45,23,45],[40,47,23,47,"onMessage"],[40,56,23,56],[40,57,23,57],[41,12,24,12,"socket"],[41,18,24,18],[41,19,24,19,"addEventListener"],[41,35,24,35],[41,36,24,36],[41,43,24,43],[41,45,24,45,"onError"],[41,52,24,52],[41,53,24,53],[42,12,25,12,"socket"],[42,18,25,18],[42,19,25,19,"addEventListener"],[42,35,25,35],[42,36,25,36],[42,42,25,42],[42,44,25,44,"onOpen"],[42,50,25,50],[42,51,25,51],[43,12,26,12],[43,16,26,16,"socket"],[43,22,26,22],[43,23,26,23,"readyState"],[43,33,26,33],[43,38,26,38,"WebSocket"],[43,47,26,47],[43,48,26,48,"CONNECTING"],[43,58,26,58],[43,60,26,60],[44,14,27,16],[44,20,27,22],[44,24,27,26,"Promise"],[44,31,27,33],[44,32,27,34],[44,33,27,35,"resolve"],[44,40,27,42],[44,42,27,44,"reject"],[44,48,27,50],[44,53,27,55],[45,16,28,20],[45,20,28,24],[45,21,28,25,"socket"],[45,27,28,31],[45,29,29,24],[46,16,30,20,"socket"],[46,22,30,26],[46,23,30,27,"onopen"],[46,29,30,33],[46,32,30,36,"resolve"],[46,39,30,43],[47,16,31,20,"socket"],[47,22,31,26],[47,23,31,27,"onerror"],[47,30,31,34],[47,33,31,37,"reject"],[47,39,31,43],[48,14,32,16],[48,15,32,17],[48,16,32,18],[49,12,33,12],[50,12,34,12],[50,16,34,27,"close_"],[50,22,34,33],[50,25,34,38,"socket"],[50,31,34,44],[50,32,34,20,"close"],[50,37,34,25],[51,12,35,12],[51,19,35,19,"Object"],[51,25,35,25],[51,26,35,26,"assign"],[51,32,35,32],[51,33,35,33,"socket"],[51,39,35,39],[51,41,35,41],[52,14,36,16,"close"],[52,19,36,21,"close"],[52,20,36,21],[52,22,36,24],[53,16,37,20,"close_"],[53,22,37,26],[53,23,37,27,"bind"],[53,27,37,31],[53,28,37,32,"socket"],[53,34,37,38],[53,35,37,39],[53,36,37,40],[53,37,37,41],[54,16,38,20,"onClose_"],[54,24,38,28],[54,25,38,29],[54,26,38,30],[55,14,39,16],[55,15,39,17],[56,14,40,16,"ping"],[56,18,40,20,"ping"],[56,19,40,20],[56,21,40,23],[57,16,41,20],[57,20,41,24],[58,18,42,24],[58,22,42,28,"socket"],[58,28,42,34],[58,29,42,35,"readyState"],[58,39,42,45],[58,44,42,50,"socket"],[58,50,42,56],[58,51,42,57,"CLOSED"],[58,57,42,63],[58,61,43,28,"socket"],[58,67,43,34],[58,68,43,35,"readyState"],[58,78,43,45],[58,83,43,50,"socket"],[58,89,43,56],[58,90,43,57,"CLOSING"],[58,97,43,64],[58,99,44,28],[58,105,44,34],[58,109,44,38,"request_js_1"],[58,121,44,50],[58,122,44,51,"WebSocketRequestError"],[58,143,44,72],[58,144,44,73],[59,20,45,32,"url"],[59,23,45,35],[59,25,45,37,"socket"],[59,31,45,43],[59,32,45,44,"url"],[59,35,45,47],[60,20,46,32,"cause"],[60,25,46,37],[60,27,46,39],[60,31,46,43,"request_js_1"],[60,43,46,55],[60,44,46,56,"SocketClosedError"],[60,61,46,73],[60,62,46,74],[61,22,46,76,"url"],[61,25,46,79],[61,27,46,81,"socket"],[61,33,46,87],[61,34,46,88,"url"],[62,20,46,92],[62,21,46,93],[63,18,47,28],[63,19,47,29],[63,20,47,30],[64,18,48,24],[64,22,48,30,"body"],[64,26,48,34],[64,29,48,37],[65,20,49,28,"jsonrpc"],[65,27,49,35],[65,29,49,37],[65,34,49,42],[66,20,50,28,"method"],[66,26,50,34],[66,28,50,36],[66,41,50,49],[67,20,51,28,"params"],[67,26,51,34],[67,28,51,36],[68,18,52,24],[68,19,52,25],[69,18,53,24,"socket"],[69,24,53,30],[69,25,53,31,"send"],[69,29,53,35],[69,30,53,36,"JSON"],[69,34,53,40],[69,35,53,41,"stringify"],[69,44,53,50],[69,45,53,51,"body"],[69,49,53,55],[69,50,53,56],[69,51,53,57],[70,16,54,20],[70,17,54,21],[70,18,55,20],[70,25,55,27,"error"],[70,30,55,32],[70,32,55,34],[71,18,56,24,"onError"],[71,25,56,31],[71,26,56,32,"error"],[71,31,56,37],[71,32,56,38],[72,16,57,20],[73,14,58,16],[73,15,58,17],[74,14,59,16,"request"],[74,21,59,23,"request"],[74,22,59,23,"_ref3"],[74,27,59,23],[74,29,59,34],[75,16,59,34],[75,20,59,26,"body"],[75,24,59,30],[75,27,59,30,"_ref3"],[75,32,59,30],[75,33,59,26,"body"],[75,37,59,30],[76,16,60,20],[76,20,60,24,"socket"],[76,26,60,30],[76,27,60,31,"readyState"],[76,37,60,41],[76,42,60,46,"socket"],[76,48,60,52],[76,49,60,53,"CLOSED"],[76,55,60,59],[76,59,61,24,"socket"],[76,65,61,30],[76,66,61,31,"readyState"],[76,76,61,41],[76,81,61,46,"socket"],[76,87,61,52],[76,88,61,53,"CLOSING"],[76,95,61,60],[76,97,62,24],[76,103,62,30],[76,107,62,34,"request_js_1"],[76,119,62,46],[76,120,62,47,"WebSocketRequestError"],[76,141,62,68],[76,142,62,69],[77,18,63,28,"body"],[77,22,63,32],[78,18,64,28,"url"],[78,21,64,31],[78,23,64,33,"socket"],[78,29,64,39],[78,30,64,40,"url"],[78,33,64,43],[79,18,65,28,"cause"],[79,23,65,33],[79,25,65,35],[79,29,65,39,"request_js_1"],[79,41,65,51],[79,42,65,52,"SocketClosedError"],[79,59,65,69],[79,60,65,70],[80,20,65,72,"url"],[80,23,65,75],[80,25,65,77,"socket"],[80,31,65,83],[80,32,65,84,"url"],[81,18,65,88],[81,19,65,89],[82,16,66,24],[82,17,66,25],[82,18,66,26],[83,16,67,20],[83,23,67,27,"socket"],[83,29,67,33],[83,30,67,34,"send"],[83,34,67,38],[83,35,67,39,"JSON"],[83,39,67,43],[83,40,67,44,"stringify"],[83,49,67,53],[83,50,67,54,"body"],[83,54,67,58],[83,55,67,59],[83,56,67,60],[84,14,68,16],[85,12,69,12],[85,13,69,13],[85,14,69,14],[86,10,69,15],[87,8,70,8],[87,9,70,9],[88,8,71,8,"keepAlive"],[88,17,71,17],[89,8,72,8,"reconnect"],[89,17,72,17],[90,8,73,8,"url"],[91,6,74,4],[91,7,74,5],[91,8,74,6],[92,4,75,0],[92,5,75,1],[93,4,75,1],[93,11,75,1,"_getWebSocketRpcClient"],[93,33,75,1],[93,34,75,1,"apply"],[93,39,75,1],[93,46,75,1,"arguments"],[93,55,75,1],[94,2,75,1],[95,0,75,1],[95,3]],"functionMap":{"names":["<global>","getWebSocketRpcClient","getSocket","Promise.resolve.then$argument_0","Promise.resolve.then.then$argument_0","onClose_","onMessage","Promise$argument_0","Object.assign$argument_1.close","Object.assign$argument_1.ping","Object.assign$argument_1.request"],"mappings":"AAA;ACK;QCG;2DCC,sBD,OE,4BF;YGE;aHM;YIC;aJE;kCKM;iBLK;gBMI;iBNG;gBOC;iBPkB;gBQC;iBRS;SDE;CDK"}},"type":"js/module"}]}
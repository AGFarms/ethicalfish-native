{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":89,"column":32,"index":3815}}],"key":"8I802z/QkQYw0PV6ZCqhBNDwn0Q="}},{"name":"../../errors/request.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":4,"column":21,"index":143},"end":{"line":4,"column":55,"index":177}}],"key":"De7+e6OpHDMvLcTikHUrC1TDF9U="}},{"name":"../promise/withTimeout.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":5,"column":25,"index":204},"end":{"line":5,"column":61,"index":240}}],"key":"26SH/OYusC1f0w4B7dthRYWX/oU="}},{"name":"../stringify.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":6,"column":23,"index":265},"end":{"line":6,"column":49,"index":291}}],"key":"kUhgJ6SYaJgEJ68ifFTgpocVrN4="}},{"name":"./id.js","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":7,"column":16,"index":309},"end":{"line":7,"column":34,"index":327}}],"key":"1P10mkSjGZG1Bi6QDHoEsrza8h0="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _asyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getHttpRpcClient = getHttpRpcClient;\n  var request_js_1 = require(_dependencyMap[1], \"../../errors/request.js\");\n  var withTimeout_js_1 = require(_dependencyMap[2], \"../promise/withTimeout.js\");\n  var stringify_js_1 = require(_dependencyMap[3], \"../stringify.js\");\n  var id_js_1 = require(_dependencyMap[4], \"./id.js\");\n  function getHttpRpcClient(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return {\n      request(params) {\n        return _asyncToGenerator(function* () {\n          var body = params.body,\n            _params$onRequest = params.onRequest,\n            onRequest = _params$onRequest === void 0 ? options.onRequest : _params$onRequest,\n            _params$onResponse = params.onResponse,\n            onResponse = _params$onResponse === void 0 ? options.onResponse : _params$onResponse,\n            _params$timeout = params.timeout,\n            timeout = _params$timeout === void 0 ? options.timeout ?? 10_000 : _params$timeout;\n          var fetchOptions = {\n            ...(options.fetchOptions ?? {}),\n            ...(params.fetchOptions ?? {})\n          };\n          var headers = fetchOptions.headers,\n            method = fetchOptions.method,\n            signal_ = fetchOptions.signal;\n          try {\n            var response = yield (0, withTimeout_js_1.withTimeout)(/*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator(function* (_ref) {\n                var signal = _ref.signal;\n                var init = {\n                  ...fetchOptions,\n                  body: Array.isArray(body) ? (0, stringify_js_1.stringify)(body.map(body => ({\n                    jsonrpc: '2.0',\n                    id: body.id ?? id_js_1.idCache.take(),\n                    ...body\n                  }))) : (0, stringify_js_1.stringify)({\n                    jsonrpc: '2.0',\n                    id: body.id ?? id_js_1.idCache.take(),\n                    ...body\n                  }),\n                  headers: {\n                    'Content-Type': 'application/json',\n                    ...headers\n                  },\n                  method: method || 'POST',\n                  signal: signal_ || (timeout > 0 ? signal : null)\n                };\n                var request = new Request(url, init);\n                var args = (yield onRequest?.(request, init)) ?? {\n                  ...init,\n                  url\n                };\n                var response = yield fetch(args.url ?? url, args);\n                return response;\n              });\n              return function (_x) {\n                return _ref2.apply(this, arguments);\n              };\n            }(), {\n              errorInstance: new request_js_1.TimeoutError({\n                body,\n                url\n              }),\n              timeout,\n              signal: true\n            });\n            if (onResponse) yield onResponse(response);\n            var data;\n            if (response.headers.get('Content-Type')?.startsWith('application/json')) data = yield response.json();else {\n              data = yield response.text();\n              try {\n                data = JSON.parse(data || '{}');\n              } catch (err) {\n                if (response.ok) throw err;\n                data = {\n                  error: data\n                };\n              }\n            }\n            if (!response.ok) {\n              throw new request_js_1.HttpRequestError({\n                body,\n                details: (0, stringify_js_1.stringify)(data.error) || response.statusText,\n                headers: response.headers,\n                status: response.status,\n                url\n              });\n            }\n            return data;\n          } catch (err) {\n            if (err instanceof request_js_1.HttpRequestError) throw err;\n            if (err instanceof request_js_1.TimeoutError) throw err;\n            throw new request_js_1.HttpRequestError({\n              body,\n              cause: err,\n              url\n            });\n          }\n        })();\n      }\n    };\n  }\n});","lineCount":109,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_asyncToGenerator"],[4,23,1,13],[4,26,1,13,"require"],[4,33,1,13],[4,34,1,13,"_dependencyMap"],[4,48,1,13],[5,2,2,0,"Object"],[5,8,2,6],[5,9,2,7,"defineProperty"],[5,23,2,21],[5,24,2,22,"exports"],[5,31,2,29],[5,33,2,31],[5,45,2,43],[5,47,2,45],[6,4,2,47,"value"],[6,9,2,52],[6,11,2,54],[7,2,2,59],[7,3,2,60],[7,4,2,61],[8,2,3,0,"exports"],[8,9,3,7],[8,10,3,8,"getHttpRpcClient"],[8,26,3,24],[8,29,3,27,"getHttpRpcClient"],[8,45,3,43],[9,2,4,0],[9,6,4,6,"request_js_1"],[9,18,4,18],[9,21,4,21,"require"],[9,28,4,28],[9,29,4,28,"_dependencyMap"],[9,43,4,28],[9,73,4,54],[9,74,4,55],[10,2,5,0],[10,6,5,6,"withTimeout_js_1"],[10,22,5,22],[10,25,5,25,"require"],[10,32,5,32],[10,33,5,32,"_dependencyMap"],[10,47,5,32],[10,79,5,60],[10,80,5,61],[11,2,6,0],[11,6,6,6,"stringify_js_1"],[11,20,6,20],[11,23,6,23,"require"],[11,30,6,30],[11,31,6,30,"_dependencyMap"],[11,45,6,30],[11,67,6,48],[11,68,6,49],[12,2,7,0],[12,6,7,6,"id_js_1"],[12,13,7,13],[12,16,7,16,"require"],[12,23,7,23],[12,24,7,23,"_dependencyMap"],[12,38,7,23],[12,52,7,33],[12,53,7,34],[13,2,8,0],[13,11,8,9,"getHttpRpcClient"],[13,27,8,25,"getHttpRpcClient"],[13,28,8,26,"url"],[13,31,8,29],[13,33,8,45],[14,4,8,45],[14,8,8,31,"options"],[14,15,8,38],[14,18,8,38,"arguments"],[14,27,8,38],[14,28,8,38,"length"],[14,34,8,38],[14,42,8,38,"arguments"],[14,51,8,38],[14,59,8,38,"undefined"],[14,68,8,38],[14,71,8,38,"arguments"],[14,80,8,38],[14,86,8,41],[14,87,8,42],[14,88,8,43],[15,4,9,4],[15,11,9,11],[16,6,10,14,"request"],[16,13,10,21,"request"],[16,14,10,22,"params"],[16,20,10,28],[16,22,10,30],[17,8,10,30],[17,15,10,30,"_asyncToGenerator"],[17,32,10,30],[18,10,11,12],[18,14,11,20,"body"],[18,18,11,24],[18,21,11,131,"params"],[18,27,11,137],[18,28,11,20,"body"],[18,32,11,24],[19,12,11,24,"_params$onRequest"],[19,29,11,24],[19,32,11,131,"params"],[19,38,11,137],[19,39,11,26,"onRequest"],[19,48,11,35],[20,12,11,26,"onRequest"],[20,21,11,35],[20,24,11,35,"_params$onRequest"],[20,41,11,35],[20,55,11,38,"options"],[20,62,11,45],[20,63,11,46,"onRequest"],[20,72,11,55],[20,75,11,55,"_params$onRequest"],[20,92,11,55],[21,12,11,55,"_params$onResponse"],[21,30,11,55],[21,33,11,131,"params"],[21,39,11,137],[21,40,11,57,"onResponse"],[21,50,11,67],[22,12,11,57,"onResponse"],[22,22,11,67],[22,25,11,67,"_params$onResponse"],[22,43,11,67],[22,57,11,70,"options"],[22,64,11,77],[22,65,11,78,"onResponse"],[22,75,11,88],[22,78,11,88,"_params$onResponse"],[22,96,11,88],[23,12,11,88,"_params$timeout"],[23,27,11,88],[23,30,11,131,"params"],[23,36,11,137],[23,37,11,90,"timeout"],[23,44,11,97],[24,12,11,90,"timeout"],[24,19,11,97],[24,22,11,97,"_params$timeout"],[24,37,11,97],[24,51,11,100,"options"],[24,58,11,107],[24,59,11,108,"timeout"],[24,66,11,115],[24,70,11,119],[24,76,11,125],[24,79,11,125,"_params$timeout"],[24,94,11,125],[25,10,12,12],[25,14,12,18,"fetchOptions"],[25,26,12,30],[25,29,12,33],[26,12,13,16],[26,16,13,20,"options"],[26,23,13,27],[26,24,13,28,"fetchOptions"],[26,36,13,40],[26,40,13,44],[26,41,13,45],[26,42,13,46],[26,43,13,47],[27,12,14,16],[27,16,14,20,"params"],[27,22,14,26],[27,23,14,27,"fetchOptions"],[27,35,14,39],[27,39,14,43],[27,40,14,44],[27,41,14,45],[28,10,15,12],[28,11,15,13],[29,10,16,12],[29,14,16,20,"headers"],[29,21,16,27],[29,24,16,57,"fetchOptions"],[29,36,16,69],[29,37,16,20,"headers"],[29,44,16,27],[30,12,16,29,"method"],[30,18,16,35],[30,21,16,57,"fetchOptions"],[30,33,16,69],[30,34,16,29,"method"],[30,40,16,35],[31,12,16,45,"signal_"],[31,19,16,52],[31,22,16,57,"fetchOptions"],[31,34,16,69],[31,35,16,37,"signal"],[31,41,16,43],[32,10,17,12],[32,14,17,16],[33,12,18,16],[33,16,18,22,"response"],[33,24,18,30],[33,33,18,39],[33,34,18,40],[33,35,18,41],[33,37,18,43,"withTimeout_js_1"],[33,53,18,59],[33,54,18,60,"withTimeout"],[33,65,18,71],[34,14,18,71],[34,18,18,71,"_ref2"],[34,23,18,71],[34,26,18,71,"_asyncToGenerator"],[34,43,18,71],[34,44,18,73],[34,55,18,73,"_ref"],[34,59,18,73],[34,61,18,95],[35,16,18,95],[35,20,18,82,"signal"],[35,26,18,88],[35,29,18,88,"_ref"],[35,33,18,88],[35,34,18,82,"signal"],[35,40,18,88],[36,16,19,20],[36,20,19,26,"init"],[36,24,19,30],[36,27,19,33],[37,18,20,24],[37,21,20,27,"fetchOptions"],[37,33,20,39],[38,18,21,24,"body"],[38,22,21,28],[38,24,21,30,"Array"],[38,29,21,35],[38,30,21,36,"isArray"],[38,37,21,43],[38,38,21,44,"body"],[38,42,21,48],[38,43,21,49],[38,46,22,30],[38,47,22,31],[38,48,22,32],[38,50,22,34,"stringify_js_1"],[38,64,22,48],[38,65,22,49,"stringify"],[38,74,22,58],[38,76,22,60,"body"],[38,80,22,64],[38,81,22,65,"map"],[38,84,22,68],[38,85,22,70,"body"],[38,89,22,74],[38,94,22,80],[39,20,23,32,"jsonrpc"],[39,27,23,39],[39,29,23,41],[39,34,23,46],[40,20,24,32,"id"],[40,22,24,34],[40,24,24,36,"body"],[40,28,24,40],[40,29,24,41,"id"],[40,31,24,43],[40,35,24,47,"id_js_1"],[40,42,24,54],[40,43,24,55,"idCache"],[40,50,24,62],[40,51,24,63,"take"],[40,55,24,67],[40,56,24,68],[40,57,24,69],[41,20,25,32],[41,23,25,35,"body"],[42,18,26,28],[42,19,26,29],[42,20,26,30],[42,21,26,31],[42,22,26,32],[42,25,27,30],[42,26,27,31],[42,27,27,32],[42,29,27,34,"stringify_js_1"],[42,43,27,48],[42,44,27,49,"stringify"],[42,53,27,58],[42,55,27,60],[43,20,28,32,"jsonrpc"],[43,27,28,39],[43,29,28,41],[43,34,28,46],[44,20,29,32,"id"],[44,22,29,34],[44,24,29,36,"body"],[44,28,29,40],[44,29,29,41,"id"],[44,31,29,43],[44,35,29,47,"id_js_1"],[44,42,29,54],[44,43,29,55,"idCache"],[44,50,29,62],[44,51,29,63,"take"],[44,55,29,67],[44,56,29,68],[44,57,29,69],[45,20,30,32],[45,23,30,35,"body"],[46,18,31,28],[46,19,31,29],[46,20,31,30],[47,18,32,24,"headers"],[47,25,32,31],[47,27,32,33],[48,20,33,28],[48,34,33,42],[48,36,33,44],[48,54,33,62],[49,20,34,28],[49,23,34,31,"headers"],[50,18,35,24],[50,19,35,25],[51,18,36,24,"method"],[51,24,36,30],[51,26,36,32,"method"],[51,32,36,38],[51,36,36,42],[51,42,36,48],[52,18,37,24,"signal"],[52,24,37,30],[52,26,37,32,"signal_"],[52,33,37,39],[52,38,37,44,"timeout"],[52,45,37,51],[52,48,37,54],[52,49,37,55],[52,52,37,58,"signal"],[52,58,37,64],[52,61,37,67],[52,65,37,71],[53,16,38,20],[53,17,38,21],[54,16,39,20],[54,20,39,26,"request"],[54,27,39,33],[54,30,39,36],[54,34,39,40,"Request"],[54,41,39,47],[54,42,39,48,"url"],[54,45,39,51],[54,47,39,53,"init"],[54,51,39,57],[54,52,39,58],[55,16,40,20],[55,20,40,26,"args"],[55,24,40,30],[55,27,40,33],[55,34,40,40,"onRequest"],[55,43,40,49],[55,46,40,52,"request"],[55,53,40,59],[55,55,40,61,"init"],[55,59,40,65],[55,60,40,66],[55,65,40,71],[56,18,40,73],[56,21,40,76,"init"],[56,25,40,80],[57,18,40,82,"url"],[58,16,40,86],[58,17,40,87],[59,16,41,20],[59,20,41,26,"response"],[59,28,41,34],[59,37,41,43,"fetch"],[59,42,41,48],[59,43,41,49,"args"],[59,47,41,53],[59,48,41,54,"url"],[59,51,41,57],[59,55,41,61,"url"],[59,58,41,64],[59,60,41,66,"args"],[59,64,41,70],[59,65,41,71],[60,16,42,20],[60,23,42,27,"response"],[60,31,42,35],[61,14,43,16],[61,15,43,17],[62,14,43,17],[62,31,43,17,"_x"],[62,33,43,17],[63,16,43,17],[63,23,43,17,"_ref2"],[63,28,43,17],[63,29,43,17,"apply"],[63,34,43,17],[63,41,43,17,"arguments"],[63,50,43,17],[64,14,43,17],[65,12,43,17],[65,17,43,19],[66,14,44,20,"errorInstance"],[66,27,44,33],[66,29,44,35],[66,33,44,39,"request_js_1"],[66,45,44,51],[66,46,44,52,"TimeoutError"],[66,58,44,64],[66,59,44,65],[67,16,44,67,"body"],[67,20,44,71],[68,16,44,73,"url"],[69,14,44,77],[69,15,44,78],[69,16,44,79],[70,14,45,20,"timeout"],[70,21,45,27],[71,14,46,20,"signal"],[71,20,46,26],[71,22,46,28],[72,12,47,16],[72,13,47,17],[72,14,47,18],[73,12,48,16],[73,16,48,20,"onResponse"],[73,26,48,30],[73,28,49,20],[73,34,49,26,"onResponse"],[73,44,49,36],[73,45,49,37,"response"],[73,53,49,45],[73,54,49,46],[74,12,50,16],[74,16,50,20,"data"],[74,20,50,24],[75,12,51,16],[75,16,51,20,"response"],[75,24,51,28],[75,25,51,29,"headers"],[75,32,51,36],[75,33,51,37,"get"],[75,36,51,40],[75,37,51,41],[75,51,51,55],[75,52,51,56],[75,54,51,58,"startsWith"],[75,64,51,68],[75,65,51,69],[75,83,51,87],[75,84,51,88],[75,86,52,20,"data"],[75,90,52,24],[75,99,52,33,"response"],[75,107,52,41],[75,108,52,42,"json"],[75,112,52,46],[75,113,52,47],[75,114,52,48],[75,115,52,49],[75,120,53,21],[76,14,54,20,"data"],[76,18,54,24],[76,27,54,33,"response"],[76,35,54,41],[76,36,54,42,"text"],[76,40,54,46],[76,41,54,47],[76,42,54,48],[77,14,55,20],[77,18,55,24],[78,16,56,24,"data"],[78,20,56,28],[78,23,56,31,"JSON"],[78,27,56,35],[78,28,56,36,"parse"],[78,33,56,41],[78,34,56,42,"data"],[78,38,56,46],[78,42,56,50],[78,46,56,54],[78,47,56,55],[79,14,57,20],[79,15,57,21],[79,16,58,20],[79,23,58,27,"err"],[79,26,58,30],[79,28,58,32],[80,16,59,24],[80,20,59,28,"response"],[80,28,59,36],[80,29,59,37,"ok"],[80,31,59,39],[80,33,60,28],[80,39,60,34,"err"],[80,42,60,37],[81,16,61,24,"data"],[81,20,61,28],[81,23,61,31],[82,18,61,33,"error"],[82,23,61,38],[82,25,61,40,"data"],[83,16,61,45],[83,17,61,46],[84,14,62,20],[85,12,63,16],[86,12,64,16],[86,16,64,20],[86,17,64,21,"response"],[86,25,64,29],[86,26,64,30,"ok"],[86,28,64,32],[86,30,64,34],[87,14,65,20],[87,20,65,26],[87,24,65,30,"request_js_1"],[87,36,65,42],[87,37,65,43,"HttpRequestError"],[87,53,65,59],[87,54,65,60],[88,16,66,24,"body"],[88,20,66,28],[89,16,67,24,"details"],[89,23,67,31],[89,25,67,33],[89,26,67,34],[89,27,67,35],[89,29,67,37,"stringify_js_1"],[89,43,67,51],[89,44,67,52,"stringify"],[89,53,67,61],[89,55,67,63,"data"],[89,59,67,67],[89,60,67,68,"error"],[89,65,67,73],[89,66,67,74],[89,70,67,78,"response"],[89,78,67,86],[89,79,67,87,"statusText"],[89,89,67,97],[90,16,68,24,"headers"],[90,23,68,31],[90,25,68,33,"response"],[90,33,68,41],[90,34,68,42,"headers"],[90,41,68,49],[91,16,69,24,"status"],[91,22,69,30],[91,24,69,32,"response"],[91,32,69,40],[91,33,69,41,"status"],[91,39,69,47],[92,16,70,24,"url"],[93,14,71,20],[93,15,71,21],[93,16,71,22],[94,12,72,16],[95,12,73,16],[95,19,73,23,"data"],[95,23,73,27],[96,10,74,12],[96,11,74,13],[96,12,75,12],[96,19,75,19,"err"],[96,22,75,22],[96,24,75,24],[97,12,76,16],[97,16,76,20,"err"],[97,19,76,23],[97,31,76,35,"request_js_1"],[97,43,76,47],[97,44,76,48,"HttpRequestError"],[97,60,76,64],[97,62,77,20],[97,68,77,26,"err"],[97,71,77,29],[98,12,78,16],[98,16,78,20,"err"],[98,19,78,23],[98,31,78,35,"request_js_1"],[98,43,78,47],[98,44,78,48,"TimeoutError"],[98,56,78,60],[98,58,79,20],[98,64,79,26,"err"],[98,67,79,29],[99,12,80,16],[99,18,80,22],[99,22,80,26,"request_js_1"],[99,34,80,38],[99,35,80,39,"HttpRequestError"],[99,51,80,55],[99,52,80,56],[100,14,81,20,"body"],[100,18,81,24],[101,14,82,20,"cause"],[101,19,82,25],[101,21,82,27,"err"],[101,24,82,30],[102,14,83,20,"url"],[103,12,84,16],[103,13,84,17],[103,14,84,18],[104,10,85,12],[105,8,85,13],[106,6,86,8],[107,4,87,4],[107,5,87,5],[108,2,88,0],[109,0,88,1],[109,3]],"functionMap":{"names":["<global>","getHttpRpcClient","request","<anonymous>","body.map$argument_0"],"mappings":"AAA;ACO;QCE;yECQ;qECI;8BDI;iBDiB;SD2C;CDE"}},"type":"js/module"}]}